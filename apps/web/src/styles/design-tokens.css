/* Design tokens for Nargis — Quiet Premium Essentialism */
:root {
  /* Ember Dawn (light) palette — default tokens for light mode */
  --color-bg: #faf8f6; /* paper-like */
  --color-surface: #ffffff;
  --color-primary: #6b46ff;
  --color-text: #0b1b2b;
  --color-muted: #6b7b86;
  --color-success: #059669;
  --color-error: #ef4444;
  --color-info: #2563eb;

  /* Spacing */
  --space-1: 4px;
  --space-2: 8px;
  --space-3: 16px;
  --msg-gap: 12px;
  --bubble-pad: 14px;

  /* Radii */
  --radius-sm: 6px;

  /* Typography */
  --font-family-sans:
    Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto,
    "Helvetica Neue", Arial;
  --font-size-body: 16px;
  --font-size-assistant: 20px;
  --line-height: 1.4;

  /* Layout */
  --content-max-width: 760px;

  /* Chrome opacity when voice active */
  --chrome-opacity: 1;
}

/* Midnight Bloom (dark) overrides — apply via `.dark` class on root */
.dark {
  --color-bg: #0f172a;
  --color-surface: #0b1220;
  --color-primary: #7c5cff;
  --color-text: #e6eef8;
  --color-muted: #9fb3c8;
  --color-info: #2563eb;
}

/* Palette tokens for user-selectable colors (used by HabitModal and others) */
:root {
  --palette-1: #3b82f6; /* blue */
  --palette-2: #10b981; /* green */
  --palette-3: #f59e0b; /* amber */
  --palette-4: #ef4444; /* red */
  --palette-5: #8b5cf6; /* purple */
  --palette-6: #ec4899; /* pink */
  --palette-7: #06b6d4; /* cyan */
  --palette-8: #f97316; /* orange */
}

.dark {
  --palette-1: #3b82f6;
  --palette-2: #10b981;
  --palette-3: #f59e0b;
  --palette-4: #ef4444;
  --palette-5: #8b5cf6;
  --palette-6: #ec4899;
  --palette-7: #06b6d4;
  --palette-8: #f97316;
}

/* Canonical aliases for legacy/global token names so components
   referencing older tokens continue to work while we migrate. These
   alias canonical tokens (like --color-text / --color-surface) and
   introduce an overlay token for subtle surfaces. */
:root {
  --color-foreground: var(--color-text);
  --color-card: var(--color-surface);
  --color-card-foreground: var(--color-text);
  /* Provide a default border tuned for Ember Dawn (light) */
  --color-border: #d6dde6;
  /* Subtle overlay used for message bubbles / assistant overlays (light)
     use a light tint over white surface. */
  --overlay-subtle: rgba(0, 0, 0, 0.04);
}

.dark {
  --color-foreground: var(--color-text);
  --color-card: var(--color-surface);
  --color-card-foreground: var(--color-text);
  --color-border: color-mix(
    in srgb,
    var(--color-surface) 88%,
    var(--color-text) 12%
  );
  --overlay-subtle: rgba(255, 255, 255, 0.02);
}

/* Layout helpers */
.app__content {
  max-width: var(--content-max-width);
  margin-left: auto;
  margin-right: auto;
  padding-left: var(--space-3);
  padding-right: var(--space-3);
}

/* Chrome dimming during voice session */
.is-voice-active .app__chrome,
.is-voice-active .app__sidebar {
  opacity: var(--chrome-opacity);
  transition: opacity 200ms cubic-bezier(0.2, 0.8, 0.2, 1);
}

/* Message bubble basics */
.message {
  display: block;
  margin-bottom: var(--msg-gap);
  padding: var(--bubble-pad);
  border-radius: var(--radius-sm);
  line-height: var(--line-height);
  font-family: var(--font-family-sans);
  font-size: var(--font-size-body);
  color: var(--color-text);
  background: var(--color-surface);
}

.message--assistant {
  font-size: var(--font-size-assistant);
  background: linear-gradient(
    180deg,
    rgba(255, 255, 255, 0.02),
    rgba(255, 255, 255, 0)
  );
  box-shadow: none;
}

.message--user {
  background: rgba(255, 255, 255, 0.02);
  opacity: 0.9;
}

/* Streaming partial text (low visual weight) */
.message--streaming .message__partial {
  color: var(--color-muted);
  font-style: italic;
  opacity: 0.9;
  transition:
    opacity 120ms ease,
    transform 160ms ease;
  transform: translateY(0);
}

/* Final assistant entrance */
.message--final {
  animation: fadeUp 160ms ease both;
}

@keyframes fadeUp {
  from {
    opacity: 0;
    transform: translateY(6px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Recording button states (visual only) */
.record-btn {
  width: 64px;
  height: 64px;
  border-radius: 50%;
  background: var(--color-primary);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  color: white;
  box-shadow: none;
  transition:
    transform 120ms ease,
    opacity 120ms ease;
}

.record-btn.rec--recording {
  animation: pulse 1000ms infinite ease-in-out;
}

@keyframes pulse {
  0% {
    transform: scale(1);
    opacity: 1;
  }
  50% {
    transform: scale(1.06);
    opacity: 0.86;
  }
  100% {
    transform: scale(1);
    opacity: 1;
  }
}

.record-btn.rec--processing {
  opacity: 0.6;
}
.record-btn.rec--disabled {
  opacity: 0.5;
  pointer-events: none;
}

/* Utility: reduced motion */
@media (prefers-reduced-motion: reduce) {
  .record-btn.rec--recording {
    animation: none;
  }
  .message--final {
    animation: none;
  }
}
